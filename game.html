<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>GÄƒseÈ™te bila</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">

<!-- Firebase COMPAT -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyC3wdh4xQDxkk2siLIbtqV1LI_Q9ahrRE8",
    authDomain: "jdrel-casino-f6ea5.firebaseapp.com",
    projectId: "jdrel-casino-f6ea5",
    appId: "1:727303157636:web:5aeb72d5adf7098efe0fd1"
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
</script>
</head>

<body>

<header>
ğŸ¯ GÄƒseÈ™te bila
<button class="logout" onclick="logout()">Logout</button>
</header>

<main class="game-area">
<button class="start-btn" onclick="startGame()">Start joc</button>

<div class="cups" id="cups">
  <div class="cup"><div class="ball"></div></div>
  <div class="cup"><div class="ball"></div></div>
  <div class="cup"><div class="ball"></div></div>
  <div class="cup"><div class="ball"></div></div>
  <div class="cup"><div class="ball"></div></div>
</div>

<div class="message" id="msg"></div>
</main>

<footer>Demo Â· Firebase Â· 18+</footer>

<script>
/* ğŸ” PROTECÈšIE */
auth.onAuthStateChanged(user=>{
  if(!user) window.location.href="index.html";
});

function logout(){
  auth.signOut().then(()=>window.location.href="index.html");
}

/* ğŸ® LOGICÄ‚ JOC */
const cups = Array.from(document.querySelectorAll(".cup"));
let ballCup = null;   // ğŸ”‘ AICI e cheia
let playing = false;

function startGame(){
  if(playing) return;
  playing = true;
  msg.innerText = "UrmÄƒreÈ™te bila";

  // reset
  cups.forEach(c=>{
    c.querySelector(".ball").style.display = "none";
    c.onclick = null;
  });

  // alegem paharul cu bila
  ballCup = cups[Math.floor(Math.random()*cups.length)];
  ballCup.querySelector(".ball").style.display = "block";

  // ascundem bila È™i amestecÄƒm
  setTimeout(()=>{
    ballCup.querySelector(".ball").style.display = "none";
    shuffle(8);
  },1500);
}

/* ğŸ”„ AMESTECARE CORECTÄ‚ + MUTARE BILÄ‚ */
function shuffle(times){
  if(times === 0){
    msg.innerText = "Alege paharul!";
    cups.forEach(c=>c.onclick = ()=>pick(c));
    playing = false;
    return;
  }

  let a = Math.floor(Math.random()*cups.length);
  let b = Math.floor(Math.random()*cups.length);
  if(a === b) return shuffle(times);

  const cupA = cups[a];
  const cupB = cups[b];

  // animaÈ›ie
  cupA.style.transform = "translateX(60px)";
  cupB.style.transform = "translateX(-60px)";

  setTimeout(()=>{
    // swap Ã®n DOM
    const parent = cupA.parentNode;
    const next = cupA.nextSibling === cupB ? cupA : cupA.nextSibling;
    parent.insertBefore(cupB, cupA);
    parent.insertBefore(cupA, next);

    // ğŸ”‘ dacÄƒ bila era sub unul din ele, MUTÄ‚ REFERINÈšA
    if(ballCup === cupA) ballCup = cupB;
    else if(ballCup === cupB) ballCup = cupA;

    // reset vizual
    cups.forEach(c=>c.style.transform="translateX(0)");

    setTimeout(()=>shuffle(times-1),200);
  },300);
}

/* ğŸ–± ALEGERE */
function pick(cup){
  cup.querySelector(".ball").style.display = "block";

  if(cup === ballCup){
    msg.innerText = "ğŸ‰ CÃ‚È˜TIG!";
  } else {
    msg.innerText = "âŒ AI PIERDUT";
  }
}
</script>

</body>
</html>
