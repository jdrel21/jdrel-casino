<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>GÄƒseÈ™te bila</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>

<header>
  ğŸ¯ GÄƒseÈ™te bila
  <div id="coins"></div>
</header>

<main class="game-area">

  <button class="start-btn" id="startBtn">
    Start joc (âˆ’1.000 coins)
  </button>

  <div class="cups-track" id="track">
    <div class="cup"><div class="ball"></div></div>
    <div class="cup"><div class="ball"></div></div>
    <div class="cup"><div class="ball"></div></div>
    <div class="cup"><div class="ball"></div></div>
    <div class="cup"><div class="ball"></div></div>
  </div>

  <div class="message" id="msg"></div>

</main>

<footer>Joc demo Â· FÄƒrÄƒ bani reali Â· 18+</footer>

<script>
const START_COINS = 100000;
const BET = 1000;
const WIN = 5000;

let cups = [];
let positions = [];
let ballIndex = -1;
let playing = false;

// init
if (!localStorage.getItem("coins")) {
  localStorage.setItem("coins", START_COINS);
}
updateCoins();

cups = Array.from(document.querySelectorAll(".cup"));
document.getElementById("startBtn").onclick = startGame;

function updateCoins(){
  document.getElementById("coins").innerText =
    "ğŸ’° Sold: " + localStorage.getItem("coins") + " coins";
}

// poziÈ›ii fixe pe axa X
function setInitialPositions(){
  const gap = 90;
  const center = Math.floor(cups.length / 2);

  cups.forEach((cup, i)=>{
    positions[i] = (i - center) * gap;
    cup.style.transform = `translateX(${positions[i]}px)`;
  });
}

// shuffle REAL (swap poziÈ›ii)
function shuffleAnimation(rounds = 8){
  let i = 0;

  let interval = setInterval(()=>{
    let a = Math.floor(Math.random() * cups.length);
    let b = Math.floor(Math.random() * cups.length);
    if(a === b) return;

    // swap poziÈ›ii
    [positions[a], positions[b]] = [positions[b], positions[a]];

    cups.forEach((cup, idx)=>{
      cup.style.transform = `translateX(${positions[idx]}px)`;
    });

    i++;
    if(i >= rounds){
      clearInterval(interval);
      document.getElementById("msg").innerText = "Alege paharul!";
      enablePick();
    }
  }, 350);
}

function startGame(){
  if(playing) return;

  let coins = +localStorage.getItem("coins");
  if(coins < BET){
    alert("Nu ai suficiente coins!");
    return;
  }

  localStorage.setItem("coins", coins - BET);
  updateCoins();

  playing = true;
  document.getElementById("msg").innerText = "UrmÄƒreÈ™te bilaâ€¦";

  cups.forEach(c=>{
    c.classList.remove("reveal");
    c.querySelector(".ball").style.display = "none";
    c.onclick = null;
  });

  setInitialPositions();

  // arÄƒtÄƒm bila
  ballIndex = Math.floor(Math.random() * cups.length);
  cups[ballIndex].querySelector(".ball").style.display = "block";

  setTimeout(()=>{
    cups[ballIndex].querySelector(".ball").style.display = "none";
    document.getElementById("msg").innerText = "Amestec pahareleâ€¦";
    shuffleAnimation();
  }, 1500);
}

function enablePick(){
  cups.forEach((cup, index)=>{
    cup.onclick = ()=> pickCup(index);
  });
}

function pickCup(index){
  if(!playing) return;
  playing = false;

  cups[index].classList.add("reveal");
  cups[ballIndex].querySelector(".ball").style.display = "block";

  if(index === ballIndex){
    localStorage.setItem(
      "coins",
      +localStorage.getItem("coins") + WIN
    );
    document.getElementById("msg").innerText =
      "ğŸ‰ CÃ‚È˜TIG! +" + WIN + " coins";
  } else {
    document.getElementById("msg").innerText =
      "âŒ Ai pierdut!";
  }

  updateCoins();
}
</script>

</body>
</html>
