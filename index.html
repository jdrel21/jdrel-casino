<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<title>GÄƒseÈ™te bila</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>

<body>

<header>
  ğŸ¯ GÄƒseÈ™te bila
  <div id="coins">ğŸ’° Sold: 0 coins</div>
</header>

<main class="game-area">

  <button class="start-btn" onclick="startGame()">
    Start joc (âˆ’1.000 coins)
  </button>

  <div class="cups" id="cups">
    <div class="cup" data-index="0"><div class="ball"></div></div>
    <div class="cup" data-index="1"><div class="ball"></div></div>
    <div class="cup" data-index="2"><div class="ball"></div></div>
    <div class="cup" data-index="3"><div class="ball"></div></div>
    <div class="cup" data-index="4"><div class="ball"></div></div>
  </div>

  <div class="message" id="msg"></div>

</main>

<footer>Joc demo Â· FÄƒrÄƒ bani reali Â· 18+</footer>

<script>
let cups = [];
let ballIndex = -1;
let playing = false;

if(!localStorage.getItem("coins")){
  localStorage.setItem("coins", 100000);
}
updateCoins();

function updateCoins(){
  document.getElementById("coins").innerText =
    "ğŸ’° Sold: " + localStorage.getItem("coins") + " coins";
}

function startGame(){
  if(playing) return;

  let coins = parseInt(localStorage.getItem("coins"));
  if(coins < 1000){
    alert("Nu ai suficiente coins!");
    return;
  }

  localStorage.setItem("coins", coins - 1000);
  updateCoins();

  playing = true;
  document.getElementById("msg").innerText = "Amestec paharele...";

  cups = Array.from(document.querySelectorAll(".cup"));

  // reset total
  cups.forEach(c=>{
    c.classList.remove("reveal");
    c.querySelector(".ball").style.display = "none";
  });

  // ALEGEM UN PAHAR, DAR NU AFIÈ˜Ä‚M BILA
  ballIndex = Math.floor(Math.random() * cups.length);

  shuffleAnimation();
}

function shuffleAnimation(){
  let moves = 8;
  let step = 90; // distanÈ›a dintre pahare
  let center = Math.floor(cups.length / 2);
  let count = 0;

  let interval = setInterval(()=>{

    // amestec logic
    cups.sort(() => Math.random() - 0.5);

    // poziÈ›ionare vizibilÄƒ
    cups.forEach((cup, i)=>{
      let offset = (i - center) * step;
      cup.style.transform = `translateX(${offset}px)`;
    });

    count++;
    if(count >= moves){
      clearInterval(interval);

      // ğŸ”´ FIXUL IMPORTANT: ALINIERE FINALÄ‚
      cups.forEach((cup, i)=>{
        let offset = (i - center) * step;
        cup.style.transform =
          `translateX(${offset}px)`;
      });

      document.getElementById("msg").innerText =
        "Alege paharul!";
      enablePick();
    }

  }, 300);
    }
    
function enablePick(){
  cups.forEach((cup)=>{
    cup.onclick = ()=> pick(cup);
  });
}

function pick(cup){
  if(!playing) return;
  playing = false;

  cup.classList.add("reveal");

  // ACUM afiÈ™Äƒm bila
  cups[ballIndex].querySelector(".ball").style.display = "block";

  if(cup === cups[ballIndex]){
    let win = 5000;
    localStorage.setItem("coins",
      parseInt(localStorage.getItem("coins")) + win
    );
    document.getElementById("msg").innerText =
      "ğŸ‰ AI CÃ‚È˜TIGAT +" + win + " coins!";
  } else {
    document.getElementById("msg").innerText =
      "âŒ Ai pierdut!";
  }

  updateCoins();
}
</script>

</body>
</html>
